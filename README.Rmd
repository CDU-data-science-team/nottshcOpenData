---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# nottshcPublic

<!-- badges: start -->
<!-- badges: end -->

This package demonstrates some of the ways we use R.

## Installation

You can install the developmental version of nottshcPublic using:

``` r
# install.packages("devtools")
devtools::install_github("CDU-data-science-team/nottshcPublic")
```

## Example

This example demonstrates how to (1) connect to the server, (2) access data on the database within R Studio, (3) tidy the data on the database, and (4) load the data into the global environment.

```{r}
# Load public package
library(nottshcPublic)
```

### 1. Connect to database

```{r}
# Create MySQL server connection
conn_mysql_suce <- connect_mysql(database = "SUCE")
```

### 2. Get data

```{r}
# Get database (db) connection for specified date range 
db_px_data <- get_px_exp(from = "2020-01-01",
                         to = "2020-12-31")

# Look at messy data
db_px_data
```

### 3. Tidy data

```{r}
# Tidy the data and select some variables 
db_px_data_tidy <- db_px_data %>% 
  tidy_px_exp() %>% 
  dplyr::select(key, comment_key, date, team_c, team_n, directorate, division,
                category, subcategory, comment_type, comment_txt, crit)

# Look at tidy data
db_px_data_tidy
```

### 4. Collect data

In case it is preferred to collect the data from the MySQL server into R the `collect()` function from `dplyr` can be used to 

```{r}
# Collect tidy data
df_px_data_tidy <- db_px_data_tidy %>% 
  dplyr::collect()

```

